This documentation tell how to set DJI m100 for onboard flight.
Largely, Three part should be done.


1. Onboard computer setting
  1-0) Install FFMPEG
  1-1) Install ROS
  1-2) Install opencv
  1-3) Install dji-osdk
  1-4) Install dji-osdk-ros

2. DJI m100 setting
  2-1) Install DJI assistant2 for m100 and set parameter
  2-2) Set USB-ttl concvetor for serail communication

3. Connection Onboard computer with m100 and Test
  3-1) execute dji-osdk without ROS
    3-1-1) set Userconfig.txt
    3-1-2) execute sample and drone activation (through DJI GO app)
  3-2) execute dji-osdk-ros with ROS
    3-2-1) Set sdk.launch file
    3-2-2) execute sample and drone activation (ADVANCED_SENSING)
4. Possible error and solution

1. Onboard computer setting
1-0) Install FFMPEG 
cd ~/
wget https://www.ffmpeg.org/releases/ffmpeg-2.8.5.tar.bz2
tar -xvf ffmpeg-2.8.5.tar.bz2
cd ffmpeg-2.8.5
./configure --disable-yasm
make && make install

1-1) Install ROS (ROS version should be matched with your ubuntu version. for ubuntu 16, ROS kinetic)
http://wiki.ros.org/kinetic/Installation/Ubuntu

1-2) Install opencv (at least, 3.4.0 version needed.)
https://webnautes.tistory.com/1186

1-3) dji-osdk isntall (3.9 version)
cd ~/
git clone https://github.com/dji-sdk/Onboard-SDK.git
cd Onboard-SDK
git checkout 295915e6da116aa2871760d3478bba7ebab2f5d9
mkdir build
cd build
cmake ..
sudo make install

1-4) dji-osdk-ros install (3.8 version)
cd catkin_ws/src
(if you don't have 'catkin_ws' amd 'src' folder, make it by using 'mkdir' command. 
 and do " catkin_init_workspace" command in the "catkin_ws/src" path. )
git clone https://github.com/dji-sdk/Onboard-SDK-ROS.git
cd Onboard-SDK-ROS
git checkout a476b746ed3414e86b41a5ed4d04cb32ddf274d0
cd ~/catkin_ws
catkin_make

2. DJI m100 setting
  2-1) Install DJI assistant2 for m100 and set parameter
  Install DJI assistant2 from below link.
  https://www.dji.com/kr/downloads/softwares/assistant-dji-2
  
  
  
  2-2) Set USB-ttl concvetor for serail communication

4. possible error and solution
1)
  CMake Warning at /opt/ros/kinetic/share/catkin/cmake/catkinConfig.cmake:76 (find_package):
    Could not find a package configuration file provided by "image_transport"
    with any of the following names:

  sol)
  sudo apt install ros-kinetic-image-transport ros-kinetic-image-transport-plugins

2) fatal error: tf/tf.h: No such file or directory
sol)
sudo apt install ros-kinetic-tf

3) New device error
sol) we should connect m100 to lightbridge2. bring lightbridge2 and turn on it. it will sound beeping. then, turn on the m100. beeping sound will be stop.
connect your phone and lightbridge2. and run dji_flightcontrol_sample. pop up message will appear on your phone. you can active your drone throught this message.

4) drone activation error/vehicle initialization failed when roslaunch dji_sdk sdk.launch
it occured due to "ADVENSED_SENSING=enadbled" in dji_sdk_node.cpp
just replace dji_sdk_node.cpp at the ~/catkin_ws/src/Onboard-SDK-ROS/dji_sdk/src/modules with modified dji_sdk_node.cpp. it is uploaded in this repository.


